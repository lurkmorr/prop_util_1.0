local a={}RegisterNUICallback('update_pos',function(b,c)local d=b.id;local e=b.d;local f=b.value;if f=='1'then f=1.0 end;if f=='0'then f=0.0 end;if f=='2'then f=2.0 end;local g=a[d]if g then local h={x=g.pos.x,y=g.pos.y,z=g.pos.z}h[e]=tonumber(f)g.pos=h;local i=g.rot;local j=g.bone;local k=PlayerPedId()DetachEntity(g.prop,true,true)AttachEntityToEntity(g.prop,k,GetPedBoneIndex(k,tonumber(j)),h.x,h.y,h.z,i.x,i.y,i.z,true,true,false,true,1,true)end;c('ok')end)RegisterNUICallback('update_rot',function(b,c)local d=b.id;local e=b.d;local f=b.value;if f=='1'then f=1.0 end;if f=='0'then f=0.0 end;if f=='2'then f=2.0 end;local g=a[d]if g then local i={x=g.rot.x,y=g.rot.y,z=g.rot.z}i[e]=tonumber(f)g.rot=i;local h=g.pos;local j=g.bone;local k=PlayerPedId()DetachEntity(g.prop,true,true)AttachEntityToEntity(g.prop,k,GetPedBoneIndex(k,tonumber(j)),h.x,h.y,h.z,i.x,i.y,i.z,true,true,false,true,1,true)end;c('ok')end)RegisterNUICallback('close',function(b,c)SetNuiFocus(false,false)c('ok')end)RegisterNUICallback('delete_prop',function(b,c)local g=a[b.id]if g then DeleteEntity(g.prop)a[b.id]=nil;SendNUIMessage({event='prop_deleted',payload={id=b.id}})end;c('ok')end)RegisterNUICallback('get_prop_data',function(b,c)local d=b.id;local g=a[d]local e;if g then e={pos={x=g.pos.x,y=g.pos.y,z=g.pos.z},rot={x=g.rot.x,y=g.rot.y,z=g.rot.z},model=g.model,bone=g.bone}else e={pos={x=0.0,y=0.0,z=0.0},rot={x=0.0,y=0.0,z=0.0},model=g.model,bone=g.bone}end;c(e)end)RegisterNUICallback('add_prop',function(b,c)local l=b.prop;local j=b.bone;local d=b.id;local g=createProp(j,l)if g then a[d]={prop=g,pos=vec(0.0,0.0,0.0),rot=vec(0.0,0.0,0.0),bone=j,model=l}SendNUIMessage({event='prop_created',payload={id=d}})end;c('ok')end)RegisterNUICallback('play_anim',function(b,c)local m=b.dict;if DoesAnimDictExist(m)then local n=b.anim;local k=PlayerPedId()RequestAnimDict(m)while not HasAnimDictLoaded(m)do Citizen.Wait(200)end;TaskPlayAnim(k,m,n,4.0,1.0,-1,1,0,0,0,0)end;c('ok')end)RegisterNUICallback('stop_anim',function(b,c)ClearPedTasks(PlayerPedId())c('ok')end)RegisterNUICallback('hide_mouse',function(b,c)SetNuiFocus(false,false)c('ok')end)function createProp(j,l,h,i,o)local p=o and l or GetHashKey(l)if IsModelValid(p)then RequestModel(p)while not HasModelLoaded(p)do Citizen.Wait(200)end;local k=PlayerPedId()local q,r,s=table.unpack(GetEntityCoords(k))local g=CreateObject(p,q,r,s-2.0,true,true,true)h=h or vec(0.0,0.0,0.0)i=i or vec(0.0,0.0,0.0)AttachEntityToEntity(g,k,GetPedBoneIndex(k,tonumber(j)),h.x,h.y,h.z,i.x,i.y,i.z,true,true,false,true,1,true)return g end end;RegisterCommand('prop',function()SetNuiFocus(false,false)end)Citizen.CreateThread(function()while true do Wait(5)InvalidateIdleCam()N_0x9e4cfff989258472()if IsControlJustReleased(0,212)then SendNUIMessage({event='open'})SetNuiFocus(true,true)end end end)
